## Formbook

总共考虑 **4** 次的运行结果

```
MD5: ea34109c78fad3492b6c181e9e442304
SHA256: 5ab40f12765a612b39c842e214dc877217074c83d7c2a4114380da8fe6a7d83c
```

||除运行恶意软件外，是否进行其他操作
-|-|-
[1](https://app.any.run/tasks/3caad1c8-a820-4fcf-9b9a-3b3bdbf46383/#)|✖
[2](https://app.any.run/tasks/732300bb-91cf-45de-a4ac-f421bbbb877f/#)|✖
[3](https://app.any.run/tasks/c3055051-a7b4-4011-a4c4-c329b7d1055b/#)|✔
[4](https://app.any.run/tasks/55498a40-2d9b-4fdf-9400-1c186cf1fc3b/#)|✔

### DNS Resolutions

- 比对 4 次的 DNS 解析请求，均不完全相同
- 每次均相同的 DNS 解析请求，但非 Formbook 相关

    Domain | IP
    -|-
    saidagruop.jp|185.26.106.165

- 部分重合的 DNS 解析请求，各请求在各个测试中出现顺序随机，均由 explorer.exe 发起

    重合测试 | Domain | IP
    -|-|-
    1,2,3|www.flekcht.com|192.64.116.112
    1,2,4|www.shannonwalden.com|Not Found
    1,4|www.animoji.love|Not Found
    2,4|www.bambinasbows.com|23.227.38.64
    3,4|www.dragappextension.com|Not Found
    1,3,4|www.ilonpolku.com|198.54.117.211,198.54.117.218,198.54.117.215,198.54.117.217,198.54.117.212,198.54.117.210,198.54.117.216
    3,4|www.kuajingge.group|Not Found
    3,4|www.oxydj.info|Not Found
    1,2|www.riskynihali.com|Not Found
    2,3|www.winecoupons.net|Not Found

- 推测存在网址集，运行时随机抽取部分网址发送请求

### HTTP Requests

- 由 explorer.exe 发起的所有 HTTP 请求，时间上均在恶意软件第一次对入侵主机的界面截图之后
- 向**不同**网站的**相同**路由发送 HTTP 请求<br>
![/crb](img/same-route.jpg)
- 发送的 POST 请求内容经过处理，不可读，GET 请求的参数也经过了处理<br>
![密文](img/post-cannot-read.jpg)
- 大部分请求已无法得到期望的 Response，但可以推测是与 CnC 服务器的通信<br>
![与 CnC 服务器的通信](img/cnc-connection.jpg)

### Others

- FormBook 会进行屏幕截图<br>
![FormBook 采集的屏幕截图](img/screenshoot.jpg)
- 采集程序使用情况及捕获输入，可能存在延迟<br>
![捕获延迟](img/delay.jpg)

## Troj/Bladabi-DR

[3a1dec8d3422df75d03c9ab20d5f1a3c13c3c022246dd5ebc10e8a33375f4a1b (MD5: 1EC786B9C11E4DB626DE3E65A8EAFA79) - Interactive analysis - ANY.RUN](https://app.any.run/tasks/b43768ef-fd29-48e3-a64b-a9dac90d5615)

### DNS Resolutions

Domain | IP
-|-
smtp.yandex.com|77.88.21.158
darkcometmarul.duckdns.org|78.179.157.23

### Connections

- 与 CnC 服务器【darkcometmarul.duckdns.org，1864 端口】通信，发送信息包括主机名、时间、系统、是否有反病毒手段等<br>
![通信内容](img/msg-send-to-cnc.jpg)
- 向 CnC 服务器发送的图片为一张极小的屏幕截图<br>
![导出图片](img/out.jpg)
- 从 smtp.yandex.com 【465 端口，但非 SMTP 协议】下载证书文件
    ```bash
    DECIMAL       HEXADECIMAL     DESCRIPTION
    --------------------------------------------------------------------------------
    228           0xE4            Certificate in DER format (x509 v3), header length: 4, sequence length: 1805
    2040          0x7F8           Certificate in DER format (x509 v3), header length: 4, sequence length: 1192
    3239          0xCA7           Certificate in DER format (x509 v3), header length: 4, sequence length: 1204
    ```

### Others

被感染主机会被强制关机

## 参考资料

- [FormBook - Malware Trends Tracker by ANY.RUN](https://any.run/malware-trends/formbook)